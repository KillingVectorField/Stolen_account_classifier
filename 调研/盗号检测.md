## 方法一：基于盗号前后行为特征的变化
在对被盗帐号的行为观察中，我们发现账号被盗后虽然也会模仿正常用户，*但其登录习惯会与历史习惯有较大差异*，表现为：
- 更改邮箱、密码等账户安全信息
- 登录时间异常
- 登录IP、地域的变化
- 信息流向的变化
- 副本任务、对战的参与频率下降
- 与其他玩家互动的频率下降
- 分解装备，转移虚拟财产等清空账号的行为


根据这些异常，早期检测盗号的方法是**基于规则的策略**。比如先刻画一段时间内的用户历史画像，通过判断用户当前行为与历史画像是否差异过大，当差异超过一定阈值后，即怀疑为盗号。

可能遇到的问题：
基于规则策略的检测方法简单直接，回溯方便，但对于以下几种情况，会产生较多误判：
- 由于用户旅行、搬迁、更换硬件设备所造成登录异常行为。
- 由于用户跟风、转发出现的消息聚集行为。
- 用户本身具有经常更换地域、设备、IP登录的特点。
- 随着用户行为特征的增加，如何给不同特征设置合适的阈值，很难通过人工直接把握。


## 方法二：基于被盗账号特征的聚集性，如ip地址，登录地点，文本消息
因为盗号的始作俑者通常有一些固定的IP、恶意内容和引流形式，因此，从网络全局的维度来看，多个被盗账号必然会行程相似的行为特征，从而在某些维度上形成聚簇。很多盗号团伙会定时定期在同一个ip或地点登录。此外被盗账号可能是由脚本、bot自动操作的，其行为特征可能有固定的模式，如固定的登录时间、登陆时长，行动轨迹等。此外，被盗账号可能与正常玩家的互动较少，如私聊次数，组队次数。由于被盗账户的特征往往有一定的相似性，我们可以直接对这些特征进行**聚类**，搜寻具有异常特征的聚类。 **由于我们有少量被盗账户的标签，我们可能可以定位出被盗账户的聚类。** 

此外，还可以用**文本消息（将simhash值作为特征）**。当黑产盗取一批用户账号后，有很大概率利用这些账号传播相似的引流信息，因此，如果一个行为异常账号转发的消息在网络中具有很大聚集性。被盗账号在消息行为上存在如下行为：
+ 传播引流信息（色情、赌博等）可能
+ 利用好友身份发送恶意链接或诈骗信息
+ 在群消息中发送钓鱼链接或诈骗信息
+ 发送的信息往往具有较强的聚集性

综上，我们可以综合利用业务场景文字信息（做simhash转换）、IP和uin作为聚集特征。

## 方法三：基于玩家互动网络（私聊、组队、交易），运行SybilRank算法
SybilRank: Aiding the Detection of Fake Accounts in Large Scale Social Online Services https://users.cs.duke.edu/~qiangcao/sybilrank_project/index.html
该算法基于如下假设：**被盗账户与正常账户间的互动较少。** 算法使用一个提前终止的随机游走，从正常账户结点出发，**当游走终止时，停留在异常账户的概率会很小。** 因为往往正常账户与被盗账户之间只有很稀少的互动。该算法会给每个结点的异常程度打分。

可能的缺陷：一些正常玩家与其他玩家的互动也很少。所以主要应该注意历史互动频率和现在的差别

## 方法四：基于被盗交易关系链，利用网络社区发现的方法
https://km.woa.com/group/1434/articles/show/151547?kmref=search&from_page=1&no=9
针对某些游戏，盗号分工明确，统一化管理，盗号，洗号，变现一条龙。其获利主要点在于，转移用户的虚拟财产，再销售给其它用户。故盗号者将大量用户的虚拟财产转移至自己的游戏账号上（我们俗称仓库号）。由此产生**交易关系链**。基于被盗交易关系链，利用**网络社区发现**的方法，我们能够检测到**以洗号者为中心**的被盗群，并检测和监控游戏账号被盗的规模和分布。

1)    基于游戏用户之间的交易行为以交易行为的用户为节点，以每次交易为边，建立无标度无向图。

2)    对交易网络进行社团的划分。盗号集团所涉及的用户可被划分至同一社团中。

3)    对任意社团，根据社团特征判定社团的类型。

4)    对任意用户，根据其所在社团的类型和本身属性特征，判定用户在交易中扮演的角色（正常用户，仓库号，被盗用户，可疑被盗，转移号）

问题一：社团类型的判定

社团被分为：正常商圈，工作室，盗号集团。

    正常商圈：交易用户之间的关系非常随机，不具有非常明显的特征

    工作室：社团内交易用户之间基本特征属性相似，交易关系稳定，交易双方存在共同的登录特征

    盗号集团：交易用户之间无关系，且都具有不同程度地登录恶意特征，用户财产全部被洗空等特点

问题二：被盗社团的判定

1、不计算用户间属性相似度，计算一个社团中某一特征值出现恶意的比例及数据，多个维度共同判定社团的恶意程度

2、对于好恶相差不大的社团，定义为正常商圈（毕竟盗号集团是少量的），但对内的用户增加其它判定恶意属性，判定其被盗的可疑程度

## 方法五：异常检测（anomaly detection）算法，如 Isolation Forest
https://en.wikipedia.org/wiki/Isolation_forest
Isolation Forest算法的基本思想是：随机选择样本的一个特征，再随机选择该特征取值范围中的一个值，对样本集做拆分，迭代该过程，生成一颗Isolation Tree；树上叶子节点离根节点越近，其异常值越高。迭代生成多颗Isolation Tree，生成Isolation Forest，预测时，融合多颗树的结果形成最终预测结果。Isolation Forest的基础结构有点类似经典的随机森林（Random Forest）。该算法最终会给出一个anomaly score，该分数接近1表示异常。

该算法的优势:
- 不需要标签，即训练数据可以只包含正常账户的数据，也可以包含异常账户的数据。 The presence of anomalies is pretty irrelevant to iForest's detection performance.
- also works well in high dimensional problems which have a large number of irrelevant attributes.

该算法在我们的应用中可能遇到的问题：
- Swamping：有时异常账户的特征会和正常账户很接近，使得iForest很难将其区分出来。这往往由于训练样本太多了。iForest算法在样本不太多时表现更好。所以应对方法为降采样，来减少样本量。
- Masking：如前所述，异常账户的特征往往有一定聚集效应，导致它们之间同样很难用决策树区分开。应对方法同样是降采样。

## 方法六：计算与有标签的黑户的亲密度
由于我们有少量实锤被盗账户的标签，与有标签的黑户有过直接互动的都可定义为可疑对象。此外还可以用Node embedding 方法（如Node2Vec）计算任意玩家与有标签的黑户的亲密度和结构相似度, 若相似/相近的也会增加可疑性。